<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>I Wanna Lockpick Puzzle Solver</title>
    <style>
        .console-output {
            width: 100%;
            height: 300px;
            overflow-y: auto;
            background-color: #333;
            color: #eee;
            font-family: monospace;
            padding: 10px;
            border: 1px solid #222;
            white-space: pre-line;
        }

        #startButton {
            margin-bottom: 10px;
        }
    </style>
</head>
<body>

<h1>I Wanna Lockpick Puzzle Solver</h1>
<label for="levelSelect">Select Level:</label>
<select id="levelSelect">
    <option value="level1.json">Level 1</option>
    <!-- Future levels can be added here as new options -->
</select>
<button id="loadLevelButton">Load Level</button>
<button id="startButton" disabled>Start Solver</button>
<div id="log" class="console-output"></div>

<script>
let puzzleData;  // This will hold the loaded level data

// Function to log messages with auto-scroll
function logMessage(message) {
    const logDiv = document.getElementById("log");
    const messageElement = document.createElement("div");
    messageElement.textContent = message;
    logDiv.appendChild(messageElement);
    logDiv.scrollTop = logDiv.scrollHeight;
}

// Function to fetch level data from JSON
async function loadLevelData(levelFile) {
    try {
        const response = await fetch(levelFile);
        puzzleData = await response.json();
        logMessage(`Loaded ${levelFile}`);
        document.getElementById("startButton").disabled = false;
    } catch (error) {
        logMessage(`Error loading level data: ${error}`);
    }
}

// Function to collect keys and log
function collectKey(data, color, amount) {
    data.keys[color].real += amount.real;
    data.keys[color].imag += amount.imag;
    logMessage(`Collected ${amount.real !== 0 ? amount.real : ''}${amount.imag !== 0 ? ' + ' + amount.imag + 'i' : ''} ${color} key(s). Total: ${data.keys[color].real} + ${data.keys[color].imag}i`);
}

// Load selected level on button click
document.getElementById("loadLevelButton").addEventListener("click", () => {
    const levelFile = document.getElementById("levelSelect").value;
    loadLevelData(levelFile);
});

// Main function to start the puzzle solver
function cursedDoorTest() {
    logMessage("Starting solver...");

    const testData = JSON.parse(JSON.stringify(puzzleData));  // Clone puzzle data

    // Collect keys for each requirement
    for (const key of testData.keysToCollect) {
        collectKey(testData, key.color, key.amount);
    }

    // Placeholder: This is where the rest of the solver logic would go
    logMessage("Solving the puzzle based on loaded data...");
}

// Add event listener to start the solver
document.getElementById("startButton").addEventListener("click", cursedDoorTest);

</script>
</body>
</html>
