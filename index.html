<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>I Wanna Lockpick Puzzle Solver</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            color: #333;
            text-align: center;
            padding: 20px;
        }
        #output {
            background-color: #e9e9e9;
            border: 1px solid #ccc;
            padding: 10px;
            max-height: 400px;
            overflow-y: scroll;
            text-align: left;
        }
    </style>
</head>
<body>
    <h1>I Wanna Lockpick Puzzle Solver</h1>
    <button onclick="startSolver()">Start Solver</button>
    <div id="output"></div>

    <script>
        const MAX_PATHS = 10000; // Limit on the number of paths to check
        const MAX_DEPTH = 100;   // Limit on steps per path to avoid endless loops
        const CHUNK_SIZE = 100;  // Number of paths to process before yielding

        let pathCount = 0;
        let outputElement = document.getElementById("output");

        function logMessage(message) {
            outputElement.innerHTML += message + "<br>";
            outputElement.scrollTop = outputElement.scrollHeight;
        }

        function solvePuzzle() {
            let queue = [{ keys: { green: 5 }, steps: 0 }]; // Example starting state

            return new Promise(resolve => {
                async function processQueue() {
                    while (queue.length > 0 && pathCount < MAX_PATHS) {
                        const batch = queue.splice(0, CHUNK_SIZE);

                        for (let state of batch) {
                            if (state.steps > MAX_DEPTH) continue;

                            if (pathCount % 1000 === 0) {
                                logMessage(`Checked ${pathCount} paths...`);
                            }

                            // Simulate door unlocking logic (replace with actual logic)
                            if (state.keys.green > 0) {
                                const newState = JSON.parse(JSON.stringify(state));
                                newState.keys.green--;
                                newState.steps++;
                                pathCount++;
                                queue.push(newState);
                                logMessage(`Opened green door with lock cost 1. Remaining green: ${newState.keys.green}`);
                            }

                            if (pathCount >= MAX_PATHS) {
                                logMessage("Reached maximum path limit. Ending search.");
                                resolve();
                                return;
                            }
                        }
                        await new Promise(r => setTimeout(r, 0)); // Yield control to the browser
                    }
                    resolve();
                }
                processQueue();
            });
        }

        async function startSolver() {
            pathCount = 0;
            outputElement.innerHTML = "Starting solver...<br>";
            await solvePuzzle();
            logMessage("Solver finished.");
        }
    </script>
</body>
</html>
